import 'package:cloud_firestore/cloud_firestore.dart';import 'package:flutter/material.dart';import 'package:otp_text_field/otp_text_field.dart';import 'package:otp_text_field/style.dart';import 'package:vendor/utility/app_color.dart';import 'package:vendor/view/auth/congratulation.dart';import 'package:vendor/view_controller/appButton.dart';import 'package:vendor/view_controller/appInput.dart';import 'package:vendor/view_controller/bigText.dart';import 'package:vendor/view_controller/richText.dart';class PhoneVerification extends StatefulWidget {  final String number;  final String user_id;  const PhoneVerification({Key? key, required this.number, required this.user_id}) : super(key: key);  @override  State<PhoneVerification> createState() => _PhoneVerificationState();}class _PhoneVerificationState extends State<PhoneVerification> {  final _number = TextEditingController();  @override  void initState() {    // TODO: implement initState    super.initState();    _number.text = widget.number;  }  @override  Widget build(BuildContext context) {    var size = MediaQuery.of(context).size;    return Scaffold(      body: Container(        width: size.width,        height: size.height,        decoration: BoxDecoration(            image: DecorationImage(                image: AssetImage("assets/images/map-bg.png")            )        ),        child: SingleChildScrollView(          child: Container(            width: size.width*.50,            padding: EdgeInsets.all(30),            margin: EdgeInsets.all(30),            decoration: BoxDecoration(              color: Colors.white,              borderRadius: BorderRadius.circular(5),            ),            child: Column(              crossAxisAlignment: CrossAxisAlignment.center,              mainAxisAlignment: MainAxisAlignment.center,              children: [                Align(                  alignment: Alignment.centerLeft,                  child: Row(                    children: [                      IconButton(                        onPressed: ()=>Navigator.pushNamed(context, "/dashboard"),                        icon: Icon(Icons.arrow_back, color: Colors.green,),                      ),                      SizedBox(width: 10,),                      Text("Go back",                        style: TextStyle(                            fontWeight: FontWeight.w600,                            color: Colors.green                        ),                      ),                    ],                  ),                ),                Image.asset("assets/images/logo.png", height: 100, width: 100,),                SizedBox(height: 30,),                BigText(text: "Number Verification Center"),                SizedBox(height: 10,),                Text("You need to Verifiy your phone number.",                  style: TextStyle(                    fontWeight: FontWeight.w400,                    fontSize: 12,                  ),                ),                SizedBox(height: 20,),                Divider(height: 1, color: Colors.grey,),                AppInput(                    controller: _number,                    title: "Phone Number",                    hintText: "Phone Number"                ),                SizedBox(height: 50,),                Row(                  mainAxisAlignment: MainAxisAlignment.center,                  children: [                    AppButton(onClick: ()=>_emailOTPVerification(), text: 'Send OTP', width: 100,),                    SizedBox(width: 10,),                    AppButton(onClick: ()=>Navigator.pop(context), bgColor: AppColors.red, text: "Later", width: 100),                  ],                )              ],            ),          ),        ),      ),    );  }  ///========= this is update User data/verifiy email ===========///  bool isLoading = false;  void _sendOTP() async{    setState(() => isLoading = true);    await FirebaseFirestore.instance.collection('vendor').doc(widget.user_id).collection("profile").doc("profile").update({      "phone" : _number.text,      "email_verification" : true    });    setState(() => isLoading = false);    Navigator.pushAndRemoveUntil(context, MaterialPageRoute(builder: (context)=>Congratulation(text: "Your email is verifed successfully. Now You can access your functionality.",)), (route) => false);  }  ///========= this is update User data/verifiy email ===========///  ///  ///  ///  ///  ///=============== email otp verification ===========//  Future<void> _emailOTPVerification() async {    var size = MediaQuery.of(context).size;    return showDialog<void>(      context: context,      barrierDismissible: false, // user must tap button!      builder: (BuildContext context) {        return AlertDialog(          content: SingleChildScrollView(            padding: EdgeInsets.all(50),            child: Align(              alignment: Alignment.center,              child: Container(                width: size.width*.25,                padding: EdgeInsets.all(20),                margin: EdgeInsets.all(20),                decoration: BoxDecoration(                    color: Colors.white,                    borderRadius: BorderRadius.circular(5)                ),                child: Column(                  children: [                    Image.asset("assets/images/logo.png", height: 100, width: 100,),                    SizedBox(height: 40,),                    BigText(text: "Email Verification"),                    SizedBox(height: 10,),                    const RichTextWidget(leftText: "We send a verification code on ", rightText: "nayon.coders@gmail.com"),                    SizedBox(height: 40,),                    OTPTextField(                      length: 5,                      width: MediaQuery.of(context).size.width,                      fieldWidth: 50,                      style: TextStyle(                          fontSize: 17,                          color: AppColors.green                      ),                      textFieldAlignment: MainAxisAlignment.spaceAround,                      fieldStyle: FieldStyle.box,                      onCompleted: (pin) {                        print("Completed: " + pin);                      },                    ),                    SizedBox(height: 30,),                    Align(                      alignment: Alignment.center,                      child: AppButton(                        width: size.width*.30,                        text: "Verify Email",                        onClick: ()=>_sendOTP(),                      ),                    ),                    SizedBox(height: 15,),                  ],                ),              ),            ),          ),          actions: <Widget>[            TextButton(              child: const Text('Cancel'),              onPressed: () {                Navigator.of(context).pop();              },            ),          ],        );      },    );  }///=============== email otp verification ===========//}