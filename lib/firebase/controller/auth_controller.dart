import 'dart:convert';import 'dart:math';import 'package:cloud_firestore/cloud_firestore.dart';import 'package:firebase_auth/firebase_auth.dart';import 'package:flutter/material.dart';import 'package:shared_preferences/shared_preferences.dart';import 'package:vendor/firebase/model/pricing_model.dart';import 'package:vendor/firebase/model/profile_model.dart';import 'package:vendor/utility/app_const.dart';class FirebaseAuthController{  ///======= vendor signup ========//  static  Future<bool> vendorRegister(      {    required BuildContext context,    required Map<String, dynamic> data  }  ) async {    try {      SharedPreferences _pref = await SharedPreferences.getInstance();      ///======= genaret erndom number =====//      // // Save user's data in vendor table      // await FirebaseFirestore.instance.collection('admin').doc("admin_$vendor_id").collection("admin_pricing").doc("admin_pricing").set(      //     {      //       "admin_pricing" : {      //      //         "monthly" : [      //           {      //             "plan_name" : "Basic Plan",      //             "price": "19.80",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "1-10 Vehicalse Management",      //               "Ticket Management",      //               "5 Team Member management",      //               "Ticket Notification",      //               "Driver Manage Management"      //             ],      //             "max_car" : 10      //           },      //           {      //             "plan_name" : "Medium Plan",      //             "price": "29.80",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "1-20 Vehicalse Management",      //               "Ticket Management",      //               "10 Team Member management",      //               "Ticket Notification",      //               "Driver Manage Management",      //               "Limiten Office Management"      //             ],      //             "max_car" : 20      //           },      //           {      //             "plan_name" : "Advance Plan",      //             "price": "39.60",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "Unlimited Vehicalse Management",      //               "Ticket Management",      //               "Unlimited Team Member management",      //               "Unlimited Ticket Notification",      //               "Unlimited Driver Manage Management",      //               "Unlimited Notification"      //             ],      //             "max_car" : "unlimited"      //           }      //         ],      //         "yearly" : [      //           {      //             "plan_name" : "Basic Plan",      //             "price": "119.80",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "1-10 Vehicalse Management",      //               "Ticket Management",      //               "5 Team Member management",      //               "Ticket Notification",      //               "Driver Manage Management"      //             ],      //             "max_car" : 10      //           },      //           {      //             "plan_name" : "Medium Plan",      //             "price": "189.80",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "1-20 Vehicalse Management",      //               "Ticket Management",      //               "10 Team Member management",      //               "Ticket Notification",      //               "Driver Manage Management",      //               "Limiten Office Management"      //             ],      //             "max_car" : 20      //           },      //           {      //             "plan_name" : "Advance Plan",      //             "price": "249.60",      //             "description" : "Lorem ipsum dolor sit amet consectetur adipisicing elit. Maxime mollitia, molestiae quas vel sint commodi repudiandae consequuntur voluptatum laborum numquam blanditiis harum quisquam ",      //             "details" : [      //               "Unlimited Vehicalse Management",      //               "Ticket Management",      //               "Unlimited Team Member management",      //               "Unlimited Ticket Notification",      //               "Unlimited Driver Manage Management",      //               "Unlimited Notification"      //             ],      //             "max_car" : "unlimited"      //           }      //         ]      //      //       }      //     }      // );      //this is firebase login      UserCredential userCredential = await FirebaseAuth.instance.createUserWithEmailAndPassword(        email: data["email"],        password: data["password"],      );      // Save user's data in vendor table      await FirebaseFirestore.instance.collection('vendor').doc("vendor_${data["email"]}").collection("profile").doc("profile").set(data);      _pref.setString("user_id", "vendor_${data["email"]}");      Navigator.pushNamedAndRemoveUntil(context, "/dashboard", (route) => false);      return true;      // Navigate to another screen or perform additional actions      // For example, you can use Navigator.pushReplacement() to go to the home screen.    } catch (e) {      print('Error during registration: $e');      return false;      // Handle registration errors (e.g., email already in use, weak password, etc.)    }  }  ///======= vendor login ========//  static   Future<bool> signInWithEmailAndPassword({required BuildContext context, required String email, required String password}) async {    try {      SharedPreferences _pref = await SharedPreferences.getInstance();      UserCredential userCredential = await FirebaseAuth.instance.signInWithEmailAndPassword(        email: email,        password: password,      );      if(userCredential != null ){        var user_Data = await FirebaseFirestore.instance.collection('vendor').doc("vendor_$email").collection("profile").doc("profile").get();         _pref.setString("user_id", "vendor_${email}");      }      // Navigate to the home screen or perform other actions upon successful login      print('User logged in: ${userCredential.user!.email}');      return true;    } catch (e) {      print('Error during login: $e');      return false;      // Handle login errors (e.g., invalid email/password, user not found, etc.)    }  }  static Future<String?> getUserId()async{      SharedPreferences _pref = await SharedPreferences.getInstance();      return _pref.getString("user_id");  }  //get vendor information  static Future<ProfileModel> getVendorInfo()async {    SharedPreferences _pref = await SharedPreferences.getInstance();    var user_id = _pref.getString("user_id");    var user_Data = await FirebaseFirestore.instance.collection('vendor').doc(        user_id).collection("profile").doc("profile").get();    print("user data: ${jsonEncode(user_Data.data())}"); //user data: {"email":"test@gmail","password":"123456","phone":"123456","name    return ProfileModel.fromJson(jsonDecode(jsonEncode(user_Data.data()!)));  }}